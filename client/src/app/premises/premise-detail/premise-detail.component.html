<div *ngIf="property">
  <div class="container bg-info ">
    <div class="row">
      <div class="col">
        <!-- address left -->
        <div class="card-body">
          <div>
            <strong>Property number</strong><br>
            {{property.premiseNumber}} <br>

            <strong>Address</strong>
            <p>{{property.premisesAddress.addressLine1}}
              {{property.premisesAddress.addressLine2}}
              {{property.premisesAddress.town}}
              {{property.premisesAddress.postCode}}</p>
          </div>
          <div>
            <strong>Contact details</strong>
            <p>{{property.phoneNumber1}}<br>
              {{property.phoneNumber2}}<br>
              {{property.email}} </p>
          </div>

          <button nz-button nzDanger routerLink='/premises/edit/{{property.id}}'>Edit property details</button>
        </div>
      </div>
      <div class="col">
        <!-- Accountant details -->
        <div class="card-body ">
          <div *ngIf="property.propAccountant; else noAccountant">
            <ul *ngFor="let item of property.propAccountant">
              <li>{{item.email}}</li>
            </ul>
          </div>
          <ng-template #noAccountant>
            No Accountant selected for this property select or Go back to the properties page to create new accountant
            <ng-container *ngIf="propAccList">
              <div class="row mt-2"> 
                <form nz-form [formGroup]="selectAccountantForm" (ngSubmit)="accSelectSubmit()">
                  <nz-select formControlName="accountant" nzAllowClear nzShowSearch nzPlaceHolder="Select users">
                    <nz-option *ngFor="let item of propAccList" [nzValue]="item.id" [nzLabel]="item.name"></nz-option>
                  </nz-select>
                      <button [disabled]="!selectAccountantForm.valid"type="submit"
                        class="btn btn-primary ml-2 p-1 h-24">Submit</button>
                </form>
              </div>
              <!---->
               
            </ng-container>

       
          </ng-template>
        </div>

      </div>
      <div class="col">

        <div class="card-body  text-right">
          <!-- task button -->
          <button nz-button nzType="primary" (click)="openTasks()">Tasks {{tasksCount}}</button>
          <nz-drawer [nzClosable]="false" [nzWidth]="420" [nzVisible]="visibleTasks" nzPlacement="right" nzTitle="Tasks"
            (nzOnClose)="closeTasks()">
            <ng-container *nzDrawerContent>
              <div *ngIf="premiseTask.length > 0; else noTasks">
                <ul *ngFor="let item of premiseTask">
                  <li>{{item.title}} <button nz-button nzType="primary" (click)="showModal(item.id)">
                      <span>View/ Edit</span></button>
                    <nz-modal [(nzVisible)]="modalVisible" nzTitle="{{item.title}}" (nzOnCancel)="handleCancel()"
                      (nzOnOk)="handleOk()" [nzOkLoading]="isOkLoading">
                      <p *nzModalContent>
                        {{modalInfo[0].description}}
                        {{modalInfo[0].completionDate}}
                      </p>
                    </nz-modal>
                  </li>
                </ul>
              </div>
              <ng-template #noTasks>
                No tasks for this property
              </ng-template>
              
              <h4 class="text-center">Create task</h4>
              <div class="text-center">
                <form [formGroup]='createTaskForm' (ngSubmit)="createTaskForm.valid && propTaskCreate()"
                  autocomplete="off">
                  <!-- <div class="form-group row"> -->

                  <div class="col-8 text-left ">
                    <label class="control-label">Title </label>
                    <app-text-input [formControl]='createTaskForm.controls["title"]' [label]='"Title"'>
                    </app-text-input>
                    <label class="control-label">Description</label>
                    <app-texarea-input [formControl]='createTaskForm.controls["description"]' [label]='"Description"'>
                    </app-texarea-input>
                    <label class="control-label">Completion date </label>
                    <app-date-input [formControl]='createTaskForm.controls["completionDate"]'
                      [label]='"Completion date"'></app-date-input>
                    <div class="row mt-5" *ngIf="validationErrors.length > 0">
                      <ul class="text-danger">
                        <li *ngFor="let error of validationErrors">
                          {{error}}
                        </li>
                      </ul>
                    </div>

                    <div class="form-group text-center">
                      <div class="text-right">
                        <div class="btn-group" role="group" aria-label="Basic example">
                          <button [disabled]="!createTaskForm.valid" type="submit"
                            class="btn btn-primary">Submit</button>
                          <button type="submit" class="btn btn-light" (click)="closeTasks()">Cancel</button>
                        </div>
                      </div>
                    </div>
                  </div>

                  <!-- </div> -->
                </form>
              </div>
            </ng-container>
          </nz-drawer>
        </div>
        <div class="card-body text-right">
          <!-- contractor -->
          <button nz-button nzType="primary" (click)="openContractor()">Contractor</button>
          <nz-drawer [nzClosable]="false" [nzWidth]="420" [nzVisible]="visibleContractor" nzPlacement="right"
            nzTitle="Contractors" (nzOnClose)="closeContractor()">
            <ng-container *nzDrawerContent>
              <div *ngIf="propContractorList.length > 0; else noContractor">
                <ul *ngFor="let item of propContractorList">
                  <li>{{item.businessName}}</li>
                </ul>
              </div>
              <ng-template #noContractor>
                No contractors linked to this property
              </ng-template>
              <div class="mt-4">
                <ng-container *ngIf="contractorsList.length > 0">
                  <form nz-form [formGroup]="contractorSelectForm" (ngSubmit)="conSelectSubmit()">
                    <nz-select formControlName="contractor" nzAllowClear nzShowSearch nzPlaceHolder="Select users">
                      <nz-option *ngFor="let item of contractorsList" [nzValue]="item.id" [nzLabel]="item.businessName">
                      </nz-option>
                    </nz-select>
                    <div class="btn-group" role="group" aria-label="Basic example">
                      <button type="submit" class="btn btn-primary">Submit</button>
                    </div>
                  </form>
                </ng-container>

              </div>
            </ng-container>
          </nz-drawer>
        </div>
      </div>
    </div>
  </div>
  <div class="container">
    <div class="row">
      <div class="col-8 mt-2">
        <div>
          <!-- <cdk-virtual-scroll-viewport itemSize="73" class="demo-infinite-container">
            <nz-list>
              <nz-list-item *cdkVirtualFor="let item of ds">
                <nz-skeleton *ngIf="!item" [nzAvatar]="true" [nzParagraph]="{ rows: 1 }"></nz-skeleton>
                <nz-list-item-meta
                  *ngIf="item"
                  nzAvatar="https://zos.alipayobjects.com/rmsportal/ODTLcjxAfvqbxHnVXCYX.png"
                  [nzDescription]="item.email"
                >
                  <nz-list-item-meta-title>
                    <a href="https://ng.ant.design">{{ item.name.last }}</a>
                  </nz-list-item-meta-title>
                </nz-list-item-meta>
              </nz-list-item>
            </nz-list>
          </cdk-virtual-scroll-viewport> -->
        </div>



        <cdk-virtual-scroll-viewport itemSize="73">
          <nz-list *ngIf="noteData.length" [nzDataSource]="data" [nzRenderItem]="item" [nzItemLayout]="'horizontal'">
            <ng-template #item let-item>
              <nz-skeleton *ngIf="!item" [nzParagraph]="{ rows: 1 }"></nz-skeleton>
              <nz-comment [nzAuthor]="item.author" [nzDatetime]="item.displayTime">
                <nz-avatar nz-comment-avatar nzIcon="user" [nzSrc]="item.avatar"></nz-avatar>
                <nz-comment-content>
                  <p>{{ item.content }}</p>
                </nz-comment-content>
              </nz-comment>
            </ng-template>
          </nz-list>
        </cdk-virtual-scroll-viewport>
        <nz-comment>
          <!-- <nz-avatar nz-comment-avatar nzIcon="user" [nzSrc]="user.avatar"></nz-avatar> -->
          <nz-comment-content>
            <nz-form-item>
              <textarea [(ngModel)]="inputValue" nz-input rows="4" style="width: 100%; max-width: 100%;"></textarea>
            </nz-form-item>
            <nz-form-item>
              <button nz-button nzType="primary" [nzLoading]="submitting" [disabled]="!inputValue"
                (click)="handleSubmit()">
                Add Comment
              </button>
            </nz-form-item>
          </nz-comment-content>
        </nz-comment>
      </div>
      <div class="col-4 mt-4">
        <div class="container ">
          <Textarea placeholder=" temp task"></Textarea>
        </div>
      </div>
    </div>
  </div>
</div>